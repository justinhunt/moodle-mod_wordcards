define("mod_wordcards/bulkimagegen",["jquery","core/log","core/ajax","core/str"],(function($,log,ajax,str){return log.debug("Bulk Image Generator: initialising"),{cmid:!1,strings:{},init:function(cmid){this.cmid=cmid,this.init_strings(),this.register_events(),log.debug("Bulk Image Generator: initialised")},init_strings:function(){var self=this;str.get_strings([{key:"noimagesgenerated",component:"mod_wordcards"},{key:"generatingimages",component:"mod_wordcards"},{key:"imagesgenerated",component:"mod_wordcards"}]).done((function(s){var i=0;self.strings.noimagesgenerated=s[i++],self.strings.generatingimages=s[i++],self.strings.imagesgenerated=s[i++]}))},register_events:function(){log.debug("registering events");var self=this,bulkbtn=$(".ww_words_fetch_image_btn"),resultscont=$(".mod_wordcards_ww_image_results");bulkbtn.on("click",(function(e){log.debug("bulkbtn clicked"),resultscont.empty(),resultscont.append("<div>"+self.strings.generatingimages+'</div><i class="fa fa-spinner fa-spin fa-3x"></i>'),resultscont.show(),bulkbtn.prop("disabled",!0),log.debug("Calling ajax to generate images"),ajax.call([{methodname:"mod_wordcards_generate_bulk_images",args:{cmid:self.cmid}}])[0].then((function(result){if(log.debug(result),resultscont.empty(),result.images&&result.images.length>0){resultscont.append("<div>"+result.images.length+" "+self.strings.imagesgenerated+"</div>");for(var i=0;i<result.images.length;i++){var image=result.images[i],img=$("<img>",{src:image.url,class:"ww_bulk_image_thumb"});resultscont.append(img)}}else resultscont.append('<div class="alert alert-info">'+self.strings.noimagesgenerated+"</div>");bulkbtn.prop("disabled",!1)})).catch((function(ex){log.error("Error generating images: ",ex),resultscont.empty(),resultscont.append('<div class="alert alert-danger">'+(ex.message||ex)+"</div>"),bulkbtn.prop("disabled",!1)}))}))}}}));

//# sourceMappingURL=bulkimagegen.min.js.map
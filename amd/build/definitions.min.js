define ("mod_wordcards/definitions",["jquery","core/ajax","core/notification","core/modal_factory","core/str","core/modal_events","mod_wordcards/a4e"],function(a,b,c,d,e,f,g){"use strict";return{strings:{},init:function init(e){var k=this;this.init_strings();var l="#"+e.widgetid,m=a(l).get(0);if(m){var n=JSON.parse(m.value);this.props=n;a(l).remove()}else{log.debug("No config found on page. Giving up.");return}var o=a(".event_flashcards"),i=a(".event_grid");a(".ProgressBar-step").on("click",function(){if(a(this).hasClass("is-current")){return!1}a(".ProgressBar-step").removeClass("is-current").removeClass("is-complete");a(this).addClass("is-current");var b=a(this).index();if(0<b){for(var c=0;c<=b;c++){a(".ProgressBar").find("li:eq("+c+")").addClass("is-complete")}}a(".definition_flashcards_ul li").slideUp(300);a(".definition_flashcards_ul").find("li:eq("+b+")").slideDown(300);a(".is-current").removeClass("is-complete");h();j()});if(window.matchMedia("(max-width: 767px)").matches){var p=a(".definition_flashcards_ul li").length;a(".wrapper_pr").append("<div class=\"mb_nav\"><span class=\"curr_level_card\">1</span> / <span class=\"tot_level_card\">"+p+"</span></div>");a(".ProgressBar").hide()}a(".definition_flashcards_ul li:gt(0)").hide();var q=a(".ProgressBar");q.children("li:first").addClass("is-current");h();j();o.click(function(b){b.preventDefault();a(".definition_flashcards").fadeIn();a(".definition_grid").fadeOut();o.addClass("btn-primary").removeClass("btn-outline-primary");i.removeClass("btn-primary").addClass("btn-outline-primary")});i.click(function(b){b.preventDefault();a(".definition_flashcards").fadeOut();a(".definition_grid").fadeIn();i.addClass("btn-primary").removeClass("btn-outline-primary");o.removeClass("btn-primary").addClass("btn-outline-primary")});function h(){var b=a(".ProgressBar");if(!0===b.children("li:first").hasClass("is-current")){a("#Prev").attr("disabled","disabled").addClass("add_opacity_level");return!0}a("#Prev").removeAttr("disabled");a("#Prev").removeAttr("disabled").removeClass("add_opacity_level")}a("#Next").click(function(){var b=a(".is-current").index()+1;a(".definition_flashcards_ul li").slideUp(300);a(".definition_flashcards_ul li:eq("+b+")").slideDown(300);var c=a(".curr_level_card").html();a(".curr_level_card").html(parseInt(c)+1);var d=a(".ProgressBar");if(0<d.children(".is-current").length){d.children(".is-current").removeClass("is-current").addClass("is-complete").next().addClass("is-current")}else{d.children().first().addClass("is-current")}h();j()});a("#Prev").click(function(){var b=a(".is-current").index()-1;a(".definition_flashcards_ul li").slideUp(300);a(".definition_flashcards_ul li:eq("+b+")").slideDown(300);var c=a(".curr_level_card").html();a(".curr_level_card").html(parseInt(c)-1);var d=a(".ProgressBar");if(0<d.children(".is-current").length){d.children(".is-current").removeClass("is-current").prev().removeClass("is-complete").addClass("is-current")}else{d.children(".is-complete").last().removeClass("is-complete").addClass("is-current")}h();j()});function j(){var b=a(".ProgressBar");if(!0===b.children("li:last").hasClass("is-current")){a("#Next").attr("disabled","disabled").addClass("add_opacity_level");return!0}a("#Next").removeAttr("disabled").removeClass("add_opacity_level")}var r=a("#definitions-page-"+e.widgetid),s=n.modid,t=n.canmanage,u=n.canattempt,v=r.find(".definitions-next");g.register_events();g.init_audio(n.token,n.region,n.owner);r.on("click",".term-seen-action",function(d){d.preventDefault();var e=a(this).parents(".term").first(),f=e.data("termid");e.addClass("term-loading");b.call([{methodname:"mod_wordcards_mark_as_seen",args:{termid:f}}])[0].then(function(b){if(!b){return a.Deferred().reject()}a(".definition_flashcards [data-termid=\""+f+"\"]").addClass("term-seen");a(".definition_grid [data-termid=\""+f+"\"]").addClass("term-seen")}).fail(c.exception).always(function(){e.removeClass("term-loading")})});v.click(function(b){b.preventDefault();var c=a(this).data("href");if("reattempt"!==a(this).data("action")){window.location.href=c;return}d.create({type:d.types.SAVE_CANCEL,title:k.strings.reattempttitle,body:k.strings.reattemptbody}).then(function(a){a.setSaveButtonText(k.strings.reattempt);var b=a.getRoot();b.on(f.save,function(){window.location.href=c});a.show()})})},init_strings:function init_strings(){var a=this;e.get_strings([{key:"reattempttitle",component:"mod_wordcards"},{key:"reattemptbody",component:"mod_wordcards"},{key:"reattempt",component:"mod_wordcards"}]).done(function(b){var c=0;a.strings.reattempttitle=b[c++];a.strings.reattemptbody=b[c++];a.strings.reattempt=b[c++]})}}});
//# sourceMappingURL=definitions.min.js.map

function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}define("mod_wordcards/dictlookup",["jquery","core/log"],(function($,log){return log.debug("Wordcards dictionary lookup: initialising"),{init:function(cmid){log.debug("Wordcards dictionary lookup: initialising"),this.cmid=cmid,this.modid=modid},english_lone:(_english_lone=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(allwords,langdef){var that,langs,promises,final_results;return regeneratorRuntime.wrap((function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(that=this,langs=["ar","id","zh","zh_tw","ja","ko","pt","es","th","vi","fr","rus"],""!==allwords.trim()){_context2.next=4;break}return _context2.abrupt("return",!1);case 4:if(-1!==langs.indexOf(langdef)){_context2.next=6;break}return _context2.abrupt("return",alllangs_lone(allwords,"en",langdef));case 6:return _context2.next=8,ajax.call([{methodname:"mod_wordcards_search_dictionary",args:{terms:allwords,cmid:that.cmid,sourcelang:"en",targetlangs:langdef}}]);case 8:return promises=_context2.sent,_context2.next=11,promises[0].done(function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(response){var repeatsearch_terms,terms,allterms_result,i,theterm,tdata,sindex,sense,sourcedefinition,alltrans,ti,translations,definition,modelsentence,repeatsearch_results;return regeneratorRuntime.wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(0!==response.success){_context.next=3;break}return log.debug(response.payload),_context.abrupt("return",!1);case 3:for(repeatsearch_terms=[],terms=JSON.parse(response.payload),allterms_result=[],i=0;i<terms.length;i++)if(0===(theterm=terms[i]).count)repeatsearch_terms.push(theterm.term);else{for(sindex in tdata={term:theterm.term,senses:[],modid:that.modid},theterm.results){for(sense=theterm.results[sindex],sourcedefinition=sense.definition,alltrans={},ti=0;ti<langs.length;ti++)alltrans[langs[ti]]=sense["lang_"+langs[ti]];translations=JSON.stringify(alltrans),definition=sourcedefinition,"en"!==langdef&&(definition=sense.hasOwnProperty("lang_"+langdef)?sense["lang_"+langdef]:"en"===langdef?sense.meaning:"No translation available"),modelsentence=sense.example,tdata.senses.push({definition:definition,sourcedefinition:sourcedefinition,modelsentence:modelsentence,senseindex:sindex,translations:translations})}allterms_result.push(tdata)}if(!(repeatsearch_terms.length>0)){_context.next=12;break}return _context.next=10,alllangs_lone(repeatsearch_terms.join(","),"en",langdef);case 10:(repeatsearch_results=_context.sent)&&(allterms_result=allterms_result.concat(repeatsearch_results));case 12:return _context.abrupt("return",allterms_result);case 13:case"end":return _context.stop()}}),_callee)})));return function(_x3){return _ref.apply(this,arguments)}}());case 11:return final_results=_context2.sent,_context2.abrupt("return",final_results);case 13:case"end":return _context2.stop()}}),_callee2,this)}))),function(_x,_x2){return _english_lone.apply(this,arguments)}),alllangs_lone:(_alllangs_lone=_asyncToGenerator(regeneratorRuntime.mark((function _callee4(allwords,sourcelang,targetlang){var that,langs,promises,final_results;return regeneratorRuntime.wrap((function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(that=this,langs={af:"Afrikaans",ar:"Arabic",bn:"Bangla",bs:"Bosnian",bg:"Bulgarian",ca:"Catalan",cs:"Czech",cy:"Welsh",da:"Danish",de:"German",el:"Greek",en:"English",es:"Spanish",et:"Estonian",fa:"Persian",fi:"Finnish",fr:"French",ht:"Haitian Creole",he:"Hebrew",hi:"Hindi",hr:"Croatian",hu:"Hungarian",id:"Indonesian",is:"Icelandic",it:"Italian",ja:"Japanese",ko:"Korean",lt:"Lithuanian",lv:"Latvian",mww:"Hmong Daw",ms:"Malay",mt:"Maltese",nl:"Dutch",nb:"Norwegian",pl:"Polish",pt:"Portuguese",ro:"Romanian",ru:"Russian","sr-Latn":"Serbian (Latin)",sk:"Slovak",sl:"Slovenian",sv:"Swedish",ta:"Tamil",th:"Thai",tr:"Turkish",uk:"Ukrainian",ur:"Urdu",vi:"Vietnamese","zh-Hans":"Chinese Simplified"},""!==allwords.trim()){_context4.next=5;break}return log.debug("no words submitted to search for"),_context4.abrupt("return",[]);case 5:if(-1!==langs.indexOf(sourcelang)&&-1!==langs.indexOf(targetlang)){_context4.next=8;break}return log.debug("MS API does not support "+sourcelang+" or "+targetlang),_context4.abrupt("return",[]);case 8:return _context4.next=10,ajax.call([{methodname:"mod_wordcards_search_dictionary",args:{terms:allwords,cmid:that.cmid,sourcelang:"en",targetlangs:langdef}}]);case 10:return promises=_context4.sent,_context4.next=13,promises[0].done(function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(response){var terms,allterms_result,i,theterm,senses,tdata,sindex,sense,definition,alltrans,translations,modelsentence;return regeneratorRuntime.wrap((function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(0!==response.success){_context3.next=3;break}return log.debug(response.payload),_context3.abrupt("return",[]);case 3:for(terms=JSON.parse(response.payload),allterms_result=[],i=0;i<terms.length;i++)if(0===(theterm=terms[i]).count)(senses=[]).push({definition:"",sourcedefinition:"No def. available",modelsentence:"",senseindex:0,translations:"{}"}),tdata={term:theterm.term,senses:senses,modid:that.modid},allterms_result.push(tdata);else{for(sindex in tdata={term:theterm.term,senses:[],modid:that.modid},theterm.results)sense=theterm.results[sindex],definition=sense.definition,(alltrans={})[targetlang]=definition,translations=JSON.stringify(alltrans),""===definition&&(definition="No translation available"),modelsentence=sense.example,tdata.senses.push({definition:definition,sourcedefinition:definition,modelsentence:modelsentence,senseindex:sindex,translations:translations});allterms_result.push(tdata)}return _context3.abrupt("return",allterms_result);case 7:case"end":return _context3.stop()}}),_callee3)})));return function(_x7){return _ref2.apply(this,arguments)}}());case 13:return final_results=_context4.sent,_context4.abrupt("return",final_results);case 15:case"end":return _context4.stop()}}),_callee4,this)}))),function(_x4,_x5,_x6){return _alllangs_lone.apply(this,arguments)})};var _alllangs_lone,_english_lone}));

//# sourceMappingURL=dictlookup.min.js.map